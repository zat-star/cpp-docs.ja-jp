---
title: "チュートリアル: 作成とスタティック ライブラリ (C++) の使用 |Microsoft ドキュメント"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: get-started-article
dev_langs:
- C++
helpviewer_keywords:
- libraries [C++], static
- static libraries [C++]
ms.assetid: 3cc36411-7d66-4240-851e-dacb9a8fd6ac
caps.latest.revision: 
author: corob-msft
ms.author: corob
manager: ghogen
ms.workload:
- cplusplus
- uwp
ms.openlocfilehash: 3af6bc41d353f82bb1f95c73f079e530da19dba0
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/21/2017
---
# <a name="walkthrough-creating-and-using-a-static-library-c"></a>チュートリアル: スタティック ライブラリの作成と使用 (C++)
このチュートリアルでは、C++ アプリケーションに使用するスタティック ライブラリ (.lib ファイル) を作成する方法について説明します。 スタティック ライブラリを使用すると、コードを有効に再利用できます。 その機能を必要とするアプリケーションごとに同じルーチンを再実装するのではなく、ルーチンを 1 度スタティック ライブラリに記述しておき、アプリケーションからそれを参照します。 スタティック ライブラリからリンクされたコードはアプリケーションの一部となります。コードを使用する別のファイルをインストールする必要はありません。  
  
 このチュートリアルでは、次の作業について説明します。  
  
-   [スタティック ライブラリ プロジェクトの作成](#BKMK_CreateLibProject)  
  
-   [スタティック ライブラリへのクラスの追加](#BKMK_AddClassToLib)  
  
-   [スタティック ライブラリを参照する C++ コンソール アプリケーションの作成](#BKMK_CreateAppToRefTheLib)  
  
-   [アプリケーションでのスタティック ライブラリの機能の使用](#BKMK_UseLibInApp)  
  
-   [アプリケーションの実行](#BKMK_RunApp)  
  
## <a name="prerequisites"></a>必須コンポーネント  
 C++ 言語の基本の理解。  
  
##  <a name="BKMK_CreateLibProject"></a> スタティック ライブラリ プロジェクトの作成  
  
#### <a name="to-create-a-static-library-project"></a>スタティック ライブラリ プロジェクトを作成するには  
  
1.  メニュー バーで、 **[ファイル]**、 **[新規作成]**、 **[プロジェクト]**の順にクリックします。  
  
2.  左側のウィンドウで、**新しいプロジェクト**] ダイアログ ボックスで、展開**インストール**、**テンプレート**、 **Visual C**、し、[ **Win32**です。  
  
3.  中央のウィンドウで **[Win32 コンソール アプリケーション]**をクリックします。  
  
4.  **[名前]**ボックスにプロジェクトの名前を入力します。たとえば、「 **MathFuncsLib** 」と入力します。 **[ソリューション名]**ボックスにソリューションの名前を入力します。たとえば、「 **StaticLibrary** 」と入力します。 **[OK]** を選択します。  
  
5.  **[Win32 アプリケーション ウィザード]** ダイアログ ボックスの **[概要]** ページで、 **[次へ]** をクリックします。  
  
6.  **[アプリケーションの設定]** ページの **[アプリケーションの種類]**で、 **[スタティック ライブラリ]**を選択します。  
  
7.  **[アプリケーションの設定]** ページの **[追加のオプション]**で、 **[プリコンパイル済みヘッダー]** のチェック ボックスをオフにします。  
  
8.  **[完了]** をクリックすると、プロジェクトが作成されます。  
  
##  <a name="BKMK_AddClassToLib"></a> スタティック ライブラリへのクラスの追加  
  
#### <a name="to-add-a-class-to-the-static-library"></a>スタティック ライブラリにクラスを追加するには  
  
1.  新しいクラスのヘッダー ファイルを作成するには、ショートカット メニューを開き、 **MathFuncsLib**プロジェクト**ソリューション エクスプ ローラー**を選択し**追加**、**新しい項目の追加**. **[新しい項目の追加]** ダイアログ ボックスの左ウィンドウで、 **[Visual C++]**の下の **[コード]**を選択します。 中央のウィンドウで、 **[ヘッダー ファイル (.h)]**をクリックします。 このヘッダー ファイルの名前を指定します。たとえば、「 **MathFuncsLib.h**」と入力します。 **[追加]** ボタンをクリックします。 空白のヘッダー ファイルが表示されます。  
  
2.  加算、減算、乗算、除算などの一般的な数値演算を行うための、 **MyMathFuncs** という名前のクラスを追加します。 コードは次のようになります。  
  
     [!code-cpp[NVC_Walkthrough_Create_Static_Lib#100](../windows/codesnippet/CPP/walkthrough-creating-and-using-a-static-library-cpp_1.h)]  
  
3.  新しいクラスのソース ファイルを作成するには、ショートカット メニューを開き、 **MathFuncsLib**でプロジェクトを**ソリューション エクスプ ローラー**を選択し**追加**、**新しい項目の追加**. **[新しい項目の追加]** ダイアログ ボックスの左ウィンドウで、 **[Visual C++]**の下の **[コード]**を選択します。 中央のウィンドウで、 **[C++ ファイル (.cpp)]**をクリックします。 このソース ファイルの名前を指定します。たとえば、「 **MathFuncsLib.cpp**」と入力します。 **[追加]** ボタンをクリックします。 空白のソース ファイルが表示されます。  
  
4.  このソース ファイルを使って、 **MyMathFuncs**の機能を実装します。 コードは次のようになります。  
  
     [!code-cpp[NVC_Walkthrough_Create_Static_Lib#110](../windows/codesnippet/CPP/walkthrough-creating-and-using-a-static-library-cpp_2.cpp)]  
  
5.  メニュー バーで **[ビルド]**、 **[ソリューションのビルド]** の順にクリックし、スタティック ライブラリをコンパイルします。 これにより、他のプログラムで使用できるスタティック ライブラリが作成されます。  
  
    > [!NOTE]
    >  プログラムを Visual Studio のコマンド ラインからビルドする場合、2 つの処理によってビルドする必要があります。 最初に、 **cl /c /EHsc MathFuncsLib.cpp** を実行してコードをコンパイルし、 **MathFuncsLib.obj**という名前のオブジェクト ファイルを作成します。(、 **Cl**コマンドは、Cl.exe コンパイラを起動し、 **/c**オプションは、リンクを行わないでコンパイルを指定します。 詳細については、次を参照してください[(コンパイルなしのリンク)/c](../build/reference/c-compile-without-linking.md)。)。2 番目に、実行**lib MathFuncsLib.obj** 、コードをリンクし、スタティック ライブラリを作成する**MathFuncsLib.lib**です。 ( **lib** コマンドは、Lib.exe ライブラリ マネージャーを起動します。 詳細については、「 [LIB Reference](../build/reference/lib-reference.md)」を参照してください)。  
  
##  <a name="BKMK_CreateAppToRefTheLib"></a> スタティック ライブラリを参照する C++ コンソール アプリケーションの作成  
  
#### <a name="to-create-a-c-console-app-that-references-the-static-library"></a>スタティック ライブラリを参照する C++ コンソール アプリケーションを作成するには  
  
1.  メニュー バーで、 **[ファイル]**、 **[新規作成]**、 **[プロジェクト]**の順にクリックします。  
  
2.  左のウィンドウで、 **[Visual C++]**から **[Win32]**をクリックします。  
  
3.  中央のウィンドウで **[Win32 コンソール アプリケーション]**をクリックします。  
  
4.  **[名前]**ボックスにプロジェクトの名前を入力します。たとえば、「 **MyExecRefsLib** 」と入力します。 **[ソリューション]**の横のドロップダウン リストで、 **[ソリューションに追加]**をクリックします。 これにより、スタティック ライブラリを含むソリューションに新しいプロジェクトを追加します。 **[OK]** をクリックします。  
  
5.  **[Win32 アプリケーション ウィザード]** ダイアログ ボックスの **[概要]** ページで、 **[次へ]** をクリックします。  
  
6.  **[アプリケーションの設定]** ページの **[アプリケーションの種類]**で、 **[コンソール アプリケーション]**を選択します。  
  
7.  **[アプリケーションの設定]** ページの **[追加のオプション]**で、 **[プリコンパイル済みヘッダー]** のチェック ボックスをオフにします。  
  
8.  **[完了]** をクリックすると、プロジェクトが作成されます。  
  
##  <a name="BKMK_UseLibInApp"></a> アプリケーションでのスタティック ライブラリの機能の使用  
  
#### <a name="to-use-the-functionality-from-the-static-library-in-the-app"></a>アプリケーションでのスタティック ライブラリの機能を使用するには  
  
1.  コンソール アプリケーションを作成すると、空のプログラムが作成されます。 ソース ファイルの名前は、前の処理で付けた名前と同じになります。 この例では、「 **MyExecRefsLib.cpp**」という名前です。  
  
2.  スタティック ライブラリの数値演算ルーチンを使用するには、それを参照する必要があります。 そのためには、 **ソリューション エクスプローラー** で、 **MyExecRefsLib**プロジェクトのショートカット メニューを開き、 **[参照設定]**をクリックします。 **MyExecRefsLibProperty ページ**] ダイアログ ボックスで、展開、**共通プロパティ**ノード、[ **Framework と参照**を選択し、**追加新しい参照**ボタンをクリックします。 詳細については、**参照**ダイアログ ボックスを参照してください[参照の追加](../ide/adding-references-in-visual-cpp-projects.md)です。  
  
3.  **[参照の追加]** ダイアログ ボックスには、参照できるライブラリが表示されます。 **[プロジェクト]** タブでは、現在のソリューション内のプロジェクト、およびそれらに含まれるすべてのライブラリが表示されます。 **[プロジェクト]** タブで、 **MathFuncsLib** のチェック ボックスをオンにし、 **[OK]** ボタンをクリックします。  
  
4.  **MathFuncsLib.h** ヘッダー ファイルを参照するには、含まれるディレクトリ パスを変更する必要があります。 **MyExecRefsLib** の **[プロパティ ページ]**ダイアログ ボックスで、 **[構成プロパティ]** ノードを展開し、 **[C/C++]** ノードを展開して、 **[全般]**をクリックします。 **[追加のインクルード ディレクトリ]**の横で、 **MathFuncsLib** ディレクトリへのパスを入力するか、参照によって指定します。  
  
     ディレクトリ パスを参照するには、プロパティ値のドロップダウン リスト ボックスを開き、 **[編集]**をクリックします。 **追加のインクルード ディレクトリ**ダイアログ ボックスのテキスト ボックスで、空白行を選択し、省略記号ボタンをクリックして (**.**)、行の末尾にします。 **[ディレクトリの選択]** ダイアログ ボックスで、 **MathFuncsLib** ディレクトリを選択し、 **[フォルダーの選択]** ボタンをクリックしてその選択を保存し、ダイアログ ボックスを閉じます。 次に **［追加のインクルード ディレクトリ］** ダイアログ ボックスで、 **[OK]** ボタンをクリックし、 **［プロパティ ページ］** ダイアログ ボックスで、 **[OK]** ボタンをクリックしてプロジェクトへの変更を保存します。  
  
5.  これで、 **MyMathFuncs** クラスをこのアプリケーションで使用できます。 そのために、 **MyExecRefsLib.cpp** の内容を次のコードに置き換えます。  
  
     [!code-cpp[NVC_Walkthrough_Create_Static_Lib#120](../windows/codesnippet/CPP/walkthrough-creating-and-using-a-static-library-cpp_3.cpp)]  
  
6.  メニュー バーで **[ビルド]**、 **[ソリューションのビルド]** の順にクリックして、実行可能ファイルをビルドします。  
  
##  <a name="BKMK_RunApp"></a> アプリケーションの実行  
  
#### <a name="to-run-the-app"></a>アプリケーションを実行するには  
  
1.  **ソリューション エクスプローラー** で **MyExecRefsLib** のショートカット メニューを開き、 **[スタートアップ プロジェクトに設定]**をクリックして、 **MyExecRefsLib**が既定のプロジェクトとして選択されていることを確認します。  
  
2.  プロジェクトを実行するには、メニュー バーで **[デバッグ]**、 **[デバッグなしで開始]**の順にクリックします。 出力は、次のようになります。  
  
    ```Output  
    a + b = 106.4  
    a - b = -91.6  
    a * b = 732.6  
    a / b = 0.0747475  
    ```  
  
## <a name="see-also"></a>参照  
 [チュートリアル: ダイナミック リンク ライブラリの作成と使用 (C++)](../build/walkthrough-creating-and-using-a-dynamic-link-library-cpp.md)   
 [デスクトップ アプリケーション (Visual C++)](../windows/desktop-applications-visual-cpp.md)