---
title: "[ヘルプ] メニューのマージ |Microsoft ドキュメント"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- C++
helpviewer_keywords:
- menus [MFC], merging
- merging Help menus [MFC]
- Help [MFC], for active document containers
ms.assetid: 9d615999-79ba-471a-9288-718f0c903d49
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: c4d3ae9509edcbe79417bb37d02f4f585b2da653
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/21/2017
---
# <a name="help-menu-merging"></a>[ヘルプ] メニューのマージ
OLE ドキュメントのプロトコルをマージするメニューがのオブジェクトの完全な制御を提供するオブジェクトがコンテナー内にあるアクティブなとき、**ヘルプ**メニュー。 その結果、ユーザーには、オブジェクトが非アクティブ化しない限り、コンテナーのヘルプ トピックは使用できません。 Active ドキュメント コンテインメントのアーキテクチャは、インプレースでメニューのコンテナーと、メニューを共有するアクティブになっているアクティブなドキュメントの両方を許可するマージの規則を展開します。 新しい規則ではどのようなコンポーネント メニューのどの部分を所有しているし、共有 メニューを構築する方法に関する規則を単に追加します。  
  
 新しい規則は単純です。 Active ドキュメントで、**ヘルプ**メニューが 2 つのトップレベルのメニュー項目が次のように構成されています。  
  
 `Help`  
  
 `Container Help >`  
  
 `Object Help    >`  
  
 単語のセクションが Office バインダーでアクティブな場合など、**ヘルプ** メニューの が次のように表示されます。  
  
 `Help`  
  
 `Binder Help >`  
  
 `Word Help   >`  
  
 両方のメニュー項目は、コンテナーおよびオブジェクトに固有の追加のメニュー項目がユーザーに提供されるカスケード メニューです。 コンテナーおよびオブジェクトとは異なりますどのような項目がここに表示します。  
  
 このマージされたを構築するために**ヘルプ**] メニューの [active ドキュメント コンテインメントのアーキテクチャは、標準の OLE ドキュメント プロシージャを変更します。 OLE ドキュメントに従ってマージされたメニュー バーが 6 つのグループがあるメニュー、つまり**ファイル**、**編集**、**コンテナー**、 `Object`、 **ウィンドウ**、**ヘルプ**点で、注文します。 各グループで、0 個以上のメニューがあります。 グループ**ファイル**、**コンテナー**、および**ウィンドウ**コンテナーのグループに属している**編集**、**オブジェクト、**と**ヘルプ**オブジェクトに属しています。 オブジェクトは、メニューをマージする場合、空のメニュー バーを作成し、コンテナーに渡します。 コンテナーは、呼び出すことによってそのメニューを挿入**IOleInPlaceFrame::InsertMenus**です。 オブジェクトも長い値が 6 つの配列は、構造体を渡します (**どおり**)。 メニューを挿入した後は、コンテナーは、そのグループ、およびしを返しますのいずれかで追加したメニューの数をマークします。 オブジェクトは、各コンテナー グループにメニュー数に注意を払い、そのメニューを挿入します。 最後に、オブジェクトは、マージされたメニュー バーと配列 (を各グループのメニューの数を含む) を渡します OLE、ハンドル不透明「メニュー記述子」がどの値を返します。 後で、オブジェクトはそのハンドルとマージされたメニュー バーを渡します、コンテナーを使用して**IOleInPlaceFrame::SetMenu**です。 この時点では、コンテナーは、マージされたメニュー バーが表示されますされ、OLE のメニュー メッセージの適切なディスパッチを実行できるようにも ole にハンドルを渡します。  
  
 変更のアクティブなドキュメントの手順で、オブジェクトを初期化する必要があります最初、**どおり**要素コンテナーを渡す前に 0 にします。 コンテナーが 1 つの例外に、通常のメニューを挿入を実行し、: コンテナーの挿入、**ヘルプ**最後の項目としてのメニューの最後 (6) のエントリに値 1 を格納し、**手順どおり**配列(つまり、幅 [5]、オブジェクトのヘルプのグループに属する)。 これは、**ヘルプ**メニューはサブメニューの場合は、項目が 1 つだけが、"**コンテナー ヘルプ**>"前述したようにカスケード メニュー。  
  
 オブジェクト、その標準のメニュー挿入コードを実行を挿入する前に点を除いて、**ヘルプ**の 6 番目のエントリをチェック] メニューの [、**どおり**配列。 値が 1 と最後のメニューの名前は**ヘルプ**(または、適切なローカライズされた文字列)、オブジェクトを挿入し、その**ヘルプ**メニューのコンテナーのサブメニューとして**ヘルプ**メニューです。  
  
 オブジェクトの 6 番目の要素を設定し、**どおり**をゼロにし、5 番目の要素を 1 ずつインクリメントします。 これにより、OLE ことに注意して、**ヘルプ**メニューが、コンテナーに属しており、コンテナーに、このメニューとその下のサブメニュー) に対応するメニュー メッセージをルーティングする必要があります。 転送するコンテナーの役割では、 `WM_INITMENUPOPUP`、 **WM_SELECT**、 **WM_COMMAND**、およびその他のメニューに関連するメッセージのオブジェクトの部分に属している、**ヘルプ**メニュー。 使用してこれを実現`WM_INITMENU`コンテナー オブジェクトのユーザーが移動するかどうかを指示するフラグをクリアする**ヘルプ**メニュー。 コンテナーを監視し、`WM_MENUSELECT`にエントリをまたはの任意の項目からの終了時、**ヘルプ** メニューのコンテナーはそれ自体を追加しませんでした。 項目で、つまりユーザーが、オブジェクト メニューにコンテナーは、"オブジェクトのヘルプ メニュー"のフラグを設定し、そのフラグの状態を使用して、いずれかを転送します`WM_MENUSELECT`、 `WM_INITMENUPOPUP`、および**WM_COMMAND**メッセージ、最低でもにオブジェクトのウィンドウです。 (終了時に、コンテナー フラグをクリアし、これらの同じメッセージをそれ自体から処理)コンテナーは、オブジェクトから返されたウィンドウを使用する必要があります**IOleInPlaceActiveObejct::GetWindow**これらのメッセージの送信先として機能します。  
  
 オブジェクト検出の 6 番目の要素に 0**どおり**、OLE ドキュメントの通常の規則に従って実行されます。 ここでに関与するコンテナーは手順**ヘルプ**メニューを満たさないとマージします。  
  
 オブジェクトが呼び出されると**IOleInPlaceFrame::SetMenu**、マージされたメニュー バーで、コンテナーのチェックするかどうかを表示する前に、**ヘルプ**メニューに、コンテナーには、新機能だけでなく、ほかのサブメニューがあります。挿入されます。 そのため、コンテナーが離れた場合その**ヘルプ**マージされたメニュー バーのメニュー。 場合、**ヘルプ**メニューが追加のサブメニューがないと、コンテナーが削除されます、**ヘルプ**マージされたメニュー バーのメニュー。 ここに参加しているオブジェクトで手順**ヘルプ**メニューを満たさないとマージします。  
  
 最後に、メニューを逆アセンブルするときは、ときに、オブジェクトを削除、挿入された**ヘルプ**もう一方を削除するだけでなくメニューがメニューを挿入します。 コンテナーは、そのメニューを削除するときを削除、**ヘルプ**だけでなく、その他のメニューが挿入されるメニュー。  
  
## <a name="see-also"></a>参照  
 [Active ドキュメント コンテナー](../mfc/active-document-containers.md)

